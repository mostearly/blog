{"componentChunkName":"component---src-templates-post-index-tsx","path":"/post/wenjianjia-tongji-he-shanchu-hanshu","result":{"data":{"markdownRemark":{"html":"<p>用于统计文件夹的大小和文件,文件夹数量.传入文件夹的绝对路径</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function\">addup_dir</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir_name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n     <span class=\"token comment\">// 初始化大小,文件数量,文件夹数量</span>\n     <span class=\"token variable\">$size</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$dir</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$file</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$handle</span> <span class=\"token operator\">=</span> <span class=\"token function\">opendir</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir_name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n         <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean constant\">false</span><span class=\"token operator\">!==</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$item</span><span class=\"token operator\">=</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$handle</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n             <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$item</span> <span class=\"token operator\">!=</span><span class=\"token single-quoted-string string\">'.'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$item</span> <span class=\"token operator\">!=</span><span class=\"token single-quoted-string string\">'..'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                 <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">is_dir</span><span class=\"token punctuation\">(</span><span class=\"token double-quoted-string string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$dir_name</span></span>/<span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">addup_dir</span><span class=\"token punctuation\">(</span><span class=\"token double-quoted-string string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$dir_name</span></span>/<span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token variable\">$size</span><span class=\"token operator\">+</span><span class=\"token operator\">=</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'size'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token variable\">$dir</span><span class=\"token operator\">+</span><span class=\"token operator\">=</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'dir'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token variable\">$file</span><span class=\"token operator\">+</span><span class=\"token operator\">=</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token variable\">$dir</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n                 <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\n                        <span class=\"token variable\">$size</span> <span class=\"token operator\">+</span><span class=\"token operator\">=</span> <span class=\"token function\">filesize</span><span class=\"token punctuation\">(</span><span class=\"token double-quoted-string string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$dir_name</span></span>/<span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token variable\">$file</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token function\">closedir</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$handle</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n     <span class=\"token keyword\">return</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'size'</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token variable\">$size</span><span class=\"token punctuation\">,</span><span class=\"token single-quoted-string string\">'dir'</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token variable\">$dir</span><span class=\"token punctuation\">,</span><span class=\"token single-quoted-string string\">'file'</span><span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>删除文件夹函数,传入绝对路径</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function\">delete_dir</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$dir_name</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$handle</span> <span class=\"token operator\">=</span> <span class=\"token function\">opendir</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir_name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n         <span class=\"token variable\">$size</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n         <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean constant\">false</span><span class=\"token operator\">!==</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$item</span><span class=\"token operator\">=</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$handle</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n             <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$item</span> <span class=\"token operator\">!=</span><span class=\"token single-quoted-string string\">'.'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$item</span> <span class=\"token operator\">!=</span><span class=\"token single-quoted-string string\">'..'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                 <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token function\">is_dir</span><span class=\"token punctuation\">(</span><span class=\"token double-quoted-string string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$dir_name</span></span>/<span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                     <span class=\"token function\">delete_dir</span><span class=\"token punctuation\">(</span><span class=\"token double-quoted-string string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$dir_name</span></span>/<span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                 <span class=\"token punctuation\">}</span>\n                 <span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\n                     <span class=\"token variable\">$size</span> <span class=\"token operator\">+</span><span class=\"token operator\">=</span> <span class=\"token function\">filesize</span><span class=\"token punctuation\">(</span><span class=\"token double-quoted-string string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$dir_name</span></span>/<span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                     <span class=\"token function\">unlink</span><span class=\"token punctuation\">(</span><span class=\"token double-quoted-string string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$dir_name</span></span>/<span class=\"token interpolation\"><span class=\"token variable\">$item</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                 <span class=\"token punctuation\">}</span>\n             <span class=\"token punctuation\">}</span>\n         <span class=\"token punctuation\">}</span>\n         <span class=\"token function\">closedir</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$handle</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">rmdir</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir_name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n             <span class=\"token keyword\">return</span> <span class=\"token boolean constant\">true</span><span class=\"token punctuation\">;</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">}</span>\n <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","id":"e3d66495-19d4-5fa6-be5a-9519b47cb5f1","fields":{"title":"文件夹统计和删除函数","tags":["PHP"],"category":"笔记","date":"2017-11-08T22:32:55+08:00","dateModified":"2017-11-08T22:32:55+08:00","slug":"/post/wenjianjia-tongji-he-shanchu-hanshu","status":true,"comment":true},"excerpt":"用于统计文件夹的大小和文件,文件夹数量.传入文件夹的绝对路径 删除文件夹函数,传入绝对路径"}},"pageContext":{"slug":"/post/wenjianjia-tongji-he-shanchu-hanshu","prev":{"slug":"/post/javascript-zhong-historypushstate-de-shiyong-jilu","title":"JavaScript中historyPushState的使用记录","date":"2017-10-19T20:25:06+08:00","category":"笔记","tags":["JavaScript"],"type":"post"},"next":{"slug":"/post/javascript-mianxiangduixiang-de-jizhong-shejimoshi","title":"JavaScript面向对象的几种设计模式","date":"2018-01-09T16:34:36+08:00","category":"笔记","tags":["JavaScript"],"type":"post"}}}}