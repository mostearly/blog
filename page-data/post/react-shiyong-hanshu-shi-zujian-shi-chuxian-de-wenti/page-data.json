{"componentChunkName":"component---src-templates-post-index-tsx","path":"/post/react-shiyong-hanshu-shi-zujian-shi-chuxian-de-wenti","result":{"data":{"markdownRemark":{"html":"<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 925px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5eedcf5f265479f56e2371ffe4422fc8/e6b01/wallhaven-zmjd7o.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.27705627705628%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAAEAQL/2gAMAwEAAhADEAAAAc5lCzDSBq//xAAZEAEBAQADAAAAAAAAAAAAAAABAAIDERL/2gAIAQEAAQUCyXIYyeZ03ULf/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAECIUH/2gAIAQMBAT8BcdZZ/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFRABAQAAAAAAAAAAAAAAAAAAIDH/2gAIAQEABj8Ci//EABkQAQADAQEAAAAAAAAAAAAAAAEAETEhQf/aAAgBAQABPyFx7YgFEV8IpeEubAVkpbP/2gAMAwEAAgADAAAAEA8f/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAh/9oACAEDAQE/EFUSU5f/xAAWEQEBAQAAAAAAAAAAAAAAAAABEQD/2gAIAQIBAT8QGsMRLv/EABsQAQACAwEBAAAAAAAAAAAAAAEAESExYUGR/9oACAEBAAE/ECNfBg0oLTS+RwpXIFBtvBG5D5CVKBoMT//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/5eedcf5f265479f56e2371ffe4422fc8/a42d1/wallhaven-zmjd7o.webp 231w,\n/static/5eedcf5f265479f56e2371ffe4422fc8/a7d21/wallhaven-zmjd7o.webp 463w,\n/static/5eedcf5f265479f56e2371ffe4422fc8/31b98/wallhaven-zmjd7o.webp 925w,\n/static/5eedcf5f265479f56e2371ffe4422fc8/5c6e0/wallhaven-zmjd7o.webp 1388w,\n/static/5eedcf5f265479f56e2371ffe4422fc8/62ac3/wallhaven-zmjd7o.webp 1850w,\n/static/5eedcf5f265479f56e2371ffe4422fc8/93e07/wallhaven-zmjd7o.webp 3840w\"\n          sizes=\"(max-width: 925px) 100vw, 925px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/5eedcf5f265479f56e2371ffe4422fc8/d4da3/wallhaven-zmjd7o.jpg 231w,\n/static/5eedcf5f265479f56e2371ffe4422fc8/ecde2/wallhaven-zmjd7o.jpg 463w,\n/static/5eedcf5f265479f56e2371ffe4422fc8/0ff56/wallhaven-zmjd7o.jpg 925w,\n/static/5eedcf5f265479f56e2371ffe4422fc8/8d810/wallhaven-zmjd7o.jpg 1388w,\n/static/5eedcf5f265479f56e2371ffe4422fc8/aa991/wallhaven-zmjd7o.jpg 1850w,\n/static/5eedcf5f265479f56e2371ffe4422fc8/e6b01/wallhaven-zmjd7o.jpg 3840w\"\n          sizes=\"(max-width: 925px) 100vw, 925px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/5eedcf5f265479f56e2371ffe4422fc8/0ff56/wallhaven-zmjd7o.jpg\"\n          alt=\"wallhaven-zmjd7o.jpg\"\n          title=\"wallhaven-zmjd7o.jpg\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">wallhaven-zmjd7o.jpg</figcaption>\n  </figure></p>\n<h1>React使用函数式组件时出现的问题</h1>\n<h2>两次渲染问题</h2>\n<p>前天在写React某个Demo代码时发现React组件渲染了两次，开始以为是state原因，因为函数式组件不使用<code class=\"language-text\">useState</code>钩子只渲染了一次，但是我思考不明白为什么React类组件和使用了<code class=\"language-text\">useState</code>钩子，开始猜测为因为<code class=\"language-text\">state</code>原因，</p>\n<p>而后在StackOverflow上面提问后经热心网友的告知才知道答案，是因为我使用了React严格模式，即使用<code class=\"language-text\">React.StrictMode</code>组件</p>\n<p>React StrictMode文档<a href=\"https://reactjs.org/docs/strict-mode.html\" target=\"_blank\" rel=\"noopener\">https://reactjs.org/docs/strict-mode.html</a></p>\n<p>文档上面给出了使用<code class=\"language-text\">React.StrictMode</code>的副作用</p>\n<blockquote>\n<p>Strict mode can’t automatically detect side effects for you, but it can help you spot them by making them a little more deterministic. This is done by intentionally double-invoking the following methods:</p>\n<ul>\n<li>Class component <code class=\"language-text\">constructor</code> method</li>\n<li>The <code class=\"language-text\">render</code> method</li>\n<li><code class=\"language-text\">setState</code> updater functions (the first argument)</li>\n<li>The static <code class=\"language-text\">getDerivedStateFromProps</code> lifecycle</li>\n<li>The <code class=\"language-text\">shouldComponentUpdate</code> method</li>\n</ul>\n</blockquote>\n<p>这次最大的问题还是出在大意上，在找问题时忽略了<code class=\"language-text\">index.js</code>，因为是使用<code class=\"language-text\">create-react-app</code>创建了，<code class=\"language-text\">App.js</code>和<code class=\"language-text\">index.js</code>都包含了<code class=\"language-text\">StrictMode</code></p>\n<h2>React函数组件在定时器获取State问题</h2>\n<iframe\n     src=\"https://codesandbox.io/embed/react-function-component-gets-state-in-timer-vyv6g?autoresize=1&fontsize=14&hidenavigation=1&initialpath=%2Freact-shiyong-hanshu-shi-zujian-he-liangci-xuanran-wenti&module=%2Fsrc%2Fcomponents%2Fcounter.tsx&theme=light&view=preview\"\n     style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\"\n     title=\"React function component gets state in timer\"\n     allow=\"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb\"\n     sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n   ></iframe>\n<p>在上面点开控制台后连续点击三次<code class=\"language-text\">Click me</code>可以看到输出了</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-powershell line-numbers\"><code class=\"language-powershell\">0\n0\n1</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>这是因为变量引用和异步的问题，在函数式很容易遇到因为变量引用而导致的不刷新，最常见的就是当使用<code class=\"language-text\">useEffect</code>这些需要填写依赖的需要将依赖正确的填写，否者就会出现因为变量引用导致值无变化进而出现问题</p>","id":"2c5d3810-4789-5864-ac77-a960d776041b","fields":{"title":"React使用函数式组件时出现的问题","tags":["React"],"category":"记录","date":"2020-03-21T16:56:18+08:00","dateModified":"2020-03-30T22:32:15+08:00","slug":"/post/react-shiyong-hanshu-shi-zujian-shi-chuxian-de-wenti","status":true,"comment":true},"excerpt":"React使用函数式组件时出现的问题 两次渲染问题 前天在写React某个Demo…"}},"pageContext":{"slug":"/post/react-shiyong-hanshu-shi-zujian-shi-chuxian-de-wenti","prev":{"slug":"/post/jiejue-wsl-yu-daili-chongtu","title":"解决WSL与代理冲突","date":"2020-03-20T20:13:27+08:00","category":"记录","tags":["WSL"],"type":"post"},"next":{"slug":"/post/nodejsreadline-biji-zhongduan-shuchu-bufen","title":"NodeJS readline笔记终端输出部分","date":"2020-03-30T18:40:00+08:00","category":"笔记","tags":["NodeJS"],"type":"post"}}}}